## Intro 
- ###  Installing Kioptrix
- ### Scanning with Nmap
- ### Enumetating HTTP and HTTPS Part 1
- ### Enumerating SMB
- ### Enumerating SSH
- ### Researching Potential Vulnerabilities
- ### Our Notes So Far
## Installing Kioptrix
Kioptrix Download - [https://tcm-sec.com/kioptrix](https://tcm-sec.com/kioptrix)

## Scanning with Nmap
#### Credintions
```copy
username: john
password: TwoCows2
```
We need to use:
```bash
sudo arp-scan -l #to find our machine
```
Acum cand avem [[IP]] adresa putem sa scanam machina noastra:
```bash
sudo nmap -sS -T4 -p- -A <IP>
```
Pentru mai multe detalii sau flaguri [[nmap]] sau [[nmap-cheatsheet-19]] 
Rezultatul scanari:
![[kioptrix.nmap.scan.nmap]]
![[Pasted image 20240206140125.png]]
Sunt deschise urmatoarele porturi si servici [[Tools/Networking tool/ssh]],[[HTTP]],[[smb]]
## Enumerating HTTP and HTTPS Part 1-2
Acesam pagina care este pe portul 80:
![[Pasted image 20240206143253.png]]
Daca accesam pagina de documentatie putem vedea urmatoare informatie:
![[Pasted image 20240206143133.png]]
Versiunea: `Apache/1.3.20`
Aici putem uteliza [[nikto]] o utilita care scaneaza vulnerabilitatile.
```bash
nikto -h http://172.16.222.128 | tee note.nikto.scan.txt
```
Folosim:
`-h` -- pentru `host`
`tee` -- pentru a salva scanarea intrun fisier 
`/usage/: Webalizer may be installed. Versions lower than 2.01-09 vulnerable to Cross Site Scripting (XSS). See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2001-0835`
Putem avea un [[Web/OWASP Juice Shop/XSS]] care are si o vulnerabilitate.
A doua vulnerabilitatea majora este [[buffer overflow]] de la `mod_ssl/2.8.4`.
`+ mod_ssl/2.8.4 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell.`
### Part 2
Folosim un instrument cu GUI [[dirbuster]] pentru a detecta toate directoarele ascunse.
![[Pasted image 20240208114505.png]]
Un rezultat dupa scanare cu instrumentul dat:
![[Pasted image 20240208114145.png]]
Si structura de tree:
![[Pasted image 20240208114211.png]]
De obicei folosesc [[gobuster]]:
```bash
gobuster dir -u http://<IP>:<PORT> -w <WORDLIST>
```
![[Pasted image 20240208114712.png]]
Intrumente de tipul dat sunt o multime [[ffuf]],[[dirsearch]]...

## Enumerating SMB
Avem un server Samba pe masina noastra dar din pacate [[nmap]] nu aduce multa informatie despre versiounea ei. Putem folosi [[msfconsole]] pentru a vedea unele module:
![[kioptrix.smb_scan_nmap]]
```bash
msfconsole -q
```
Am primit urmatoarea informatie:
```msfcons
msf6 auxiliary(scanner/smb/smb_version) > run  
  \
[*] 172.16.222.128:139    - SMB Detected (versions:) (preferred dialect:) (signatures:optional)  
[*] 172.16.222.128:139    -   Host could not be identified: Unix (Samba 2.2.1a)  
[*] 172.16.222.128:       - Scanned 1 of 1 hosts (100% complete)  
[*] Auxiliary module execution completed 
```
Acum putem gasi un exploit:
Dar sa mai incercam un lucru sa vedem daca putem sa ne connectam `anonymous` pe serverul nostru facem acest lucru cu utilita [[smbclient]]:
```bash
smbclient -L ////<IP-Server>////
```
`-L` -- returneaza o lista de folderuri 
![[Screenshot_20240208_133112 1.png]]
La moment avem 2 locatii `IPC$`,`ADMIN$` care poate sa ne intereseze.
Putem sa ne conectam la `IPC$` dar nu avem nici un fisier.
```bash
smbclient \\\\172.16.222.128\IPC$
```
![[Pasted image 20240208134203.png]]
## Enumerating SSH
Putem prinde un baner cand incercam sa ne logam:
```bash
ssh -oKexAlgorithms=diffie-hellman-group1-sha1 -oHostKeyAlgorithms=+ssh-rsa -c aes256-cbc root@172.16.22  
2.128
```
In cazul dat nu avem nici versiune:
![[Pasted image 20240208140127.png]]
## Researching Potential Vulnerabilities
Cautam versiunele de vulnerabilitati pe net git, exploit-db.
