FLAGC{59f31e7e89b070bZ 30d1ffbeea7645a4aa998bf}

## Check
`/etc/debconf.conf:Filename: /var/cache/debconf/passwords.dat`
`-rwxr-xr-x 1 root root 52090 Feb 10  2023 /usr/bin/wsrep_sst_mariabackup  
`-rwxr-xr-x 1 root root 3025 Feb 10  2023 /usr/bin/wsrep_sst_backup``

## Root files
```
Looking for root files in folders owned by me  
-rw-r--r-- 1 root root 342 Aug 23 09:32 /var/www/html/exec.php  
-rw-r--r-- 1 root root 218 Aug 23 10:10 /var/www/html/wp-content/themes/twentytwentyone/assets/flag.zip  
-rw-r--r-- 1 root root 5679272 Aug 29 08:44 /var/www/html/FlagA.apk  
-rw-r--r-- 1 root root 342 Aug 23 09:32 /var/www/html/exec.php  
-rw-r--r-- 1 root root 218 Aug 23 10:10 /var/www/html/wp-content/themes/twentytwentyone/assets/flag.zip  
-rw-r--r-- 1 root root 5679272 Aug 29 08:44 /var/www/html/FlagA.apk  
-rw-r--r-- 1 root root 218 Aug 23 10:10 /var/www/html/wp-content/themes/twentytwentyone/assets/flag.zip  
-rw-r--r-- 1 root root 218 Aug 23 10:10 /var/www/html/wp-content/themes/twentytwentyone/assets/flag.zip  
-rw-r--r-- 1 root root 218 Aug 23 10:10 /var/www/html/wp-content/themes/twentytwentyone/assets/flag.zip  
-rw-r--r-- 1 root root 218 Aug 23 10:10 /var/www/html/wp-content/themes/twentytwentyone/assets/flag.zip
```

## Script 
```
[+] .sh files in path  
/usr/bin/rescan-scsi-bus.sh  
/usr/bin/gettext.sh
```

## SUID
```
[+] SUID  
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#commands-with-sudo-and-suid-commands  
/snap/core20/2015/usr/bin/chfn          --->    SuSE_9.3/10  
/snap/core20/2015/usr/bin/chsh  
/snap/core20/2015/usr/bin/gpasswd  
/snap/core20/2015/usr/bin/mount         --->    Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8  
/snap/core20/2015/usr/bin/newgrp                --->    HP-UX_10.20  
/snap/core20/2015/usr/bin/passwd                --->    Apple_Mac_OSX/Solaris/SPARC_8/9/Sun_Solaris_2.5.1_PAM  
/snap/core20/2015/usr/bin/su  
/snap/core20/2015/usr/bin/sudo          --->    /sudo$  
/snap/core20/2015/usr/bin/umount                --->    BSD/Linux[1996-08-13]  
/snap/core20/2015/usr/lib/dbus-1.0/dbus-daemon-launch-helper  
/snap/core20/2015/usr/lib/openssh/ssh-keysign  
/snap/core20/1587/usr/bin/chfn          --->    SuSE_9.3/10  
/snap/core20/1587/usr/bin/chsh  
/snap/core20/1587/usr/bin/gpasswd  
/snap/core20/1587/usr/bin/mount         --->    Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8  
/snap/core20/1587/usr/bin/newgrp                --->    HP-UX_10.20  
/snap/core20/1587/usr/bin/passwd                --->    Apple_Mac_OSX/Solaris/SPARC_8/9/Sun_Solaris_2.5.1_PAM  
/snap/core20/1587/usr/bin/su  
/snap/core20/1587/usr/bin/sudo          --->    /sudo$  
/snap/core20/1587/usr/bin/umount                --->    BSD/Linux[1996-08-13]  
/snap/core20/1587/usr/lib/dbus-1.0/dbus-daemon-launch-helper  
/snap/core20/1587/usr/lib/openssh/ssh-keysign  
/snap/snapd/19993/usr/lib/snapd/snap-confine  
/snap/snapd/20092/usr/lib/snapd/snap-confine  
/usr/bin/mount          --->    Apple_Mac_OSX(Lion)_Kernel_xnu-1699.32.7_except_xnu-1699.24.8  
/usr/bin/pkexec         --->    rhel_6/Also_check_groups_privileges_and_pkexec_policy  
/usr/bin/fusermount3  
/usr/bin/passwd         --->    Apple_Mac_OSX/Solaris/SPARC_8/9/Sun_Solaris_2.5.1_PAM  
/usr/bin/sudo           --->    /sudo$  
/usr/bin/elevator  
/usr/bin/chsh  
/usr/bin/gpasswd  
/usr/bin/chfn           --->    SuSE_9.3/10  
/usr/bin/newgrp         --->    HP-UX_10.20  
/usr/bin/su  
/usr/bin/umount         --->    BSD/Linux[1996-08-13]  
/usr/libexec/polkit-agent-helper-1  
/usr/lib/openssh/ssh-keysign  
/usr/lib/snapd/snap-confine  
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
```

## Database
```
[+] Looking for Wordpress wp-config.php files  
wp-config.php files found:  
/var/www/html/wp-config.php  
define( 'DB_NAME', 'safeshop_01' );  
define( 'DB_USER', 'safeuser_01' );  
define( 'DB_PASSWORD', 'JpdVJETEhTbufrsWZQWnE8rr' );  
define( 'DB_HOST', '127.0.0.1' );
```

## Connect to BD
```
Found lib_mysqludf_sys.so:  
If you can login in MySQL you can execute commands doing: SELECT sys_eval('id');  
Found lib_mysqludf_sys.so:  
If you can login in MySQL you can execute commands doing: SELECT sys_eval('id');
```

## User
```
_apt  
backup  
bin  
daemon  
games  
gnats  
irc  
landscape  
list  
lp  
lxd  
mail  
man  
messagebus  
mysql  
news  
nobody  
pollinate  
proxy  
root  
sshd  
sync  
sys  
syslog  
systemd-network  
systemd-resolve  
systemd-timesync  
tcpdump  
tss  
usbmux  
uucp  
uuidd  
www-data
```
## Credition
`safe:0zq5p!(Fm71rI(k)HU`

```
www-data@ctfs2023:~/html/wp-admin$ cat /etc/debconf.conf  
cat /etc/debconf.conf  
# This is the main config file for debconf. It tells debconf where to  
# store data. The format of this file is a set of stanzas. Each stanza  
# except the first sets up a database for debconf to use. For details, see  
# debconf.conf(5) (in the debconf-doc package).  
#  
# So first things first. This first stanza gives the names of two databases.  
  
# Debconf will use this database to store the data you enter into it,  
# and some other dynamic data.  
Config: configdb  
# Debconf will use this database to store static template data.  
Templates: templatedb  
  
# World-readable, and accepts everything but passwords.  
Name: config  
Driver: File  
Mode: 644  
Reject-Type: password  
Filename: /var/cache/debconf/config.dat  
  
# Not world readable (the default), and accepts only passwords.  
Name: passwords  
Driver: File  
Mode: 600  
Backup: false  
Required: false  
Accept-Type: password  
Filename: /var/cache/debconf/passwords.dat  
  
# Set up the configdb database. By default, it consists of a stack of two  
# databases, one to hold passwords and one for everything else.  
Name: configdb  
Driver: Stack  
Stack: config, passwords  
  
# Set up the templatedb database, which is a single flat text file  
# by default.  
Name: templatedb  
Driver: File  
Mode: 644  
Filename: /var/cache/debconf/templates.dat  
  
# Well that was pretty straightforward, and it will be enough for most  
# people's needs, but debconf's database drivers can be used to do much  
# more interesting things. For example, suppose you want to use config    
# data from another host, which is mounted over nfs or perhaps the database  
# is accessed via LDAP. You don't want to write to the remote debconf database,  
# just read from it, so you still need a local database for local changes.  
#  
# A remote NFS mounted database, read-only. It is optional; if debconf  
# fails to use it it will not abort.  
#Name: remotedb  
#Driver: DirTree  
#Directory: /mnt/otherhost/var/cache/debconf/config  
#Readonly: true  
#Required: false  
#  
# A remote LDAP database. It is also read-only. The password is really  
# only necessary if the database is not accessible anonymously.  
# Option KeyByKey instructs the backend to retrieve keys from the LDAP  
# server individually (when they are requested), instead of loading all  
# keys at startup. The default is 0, and should only be enabled if you  
# want to track accesses to individual keys on the LDAP server side.  
#Name: remotedb  
#Driver: LDAP  
#Server: remotehost  
#BaseDN: cn=debconf,dc=domain,dc=com  
#BindDN: uid=admin,dc=domain,dc=com  
#BindPasswd: secret  
#KeyByKey: 0  
#  
# A stack consisting of two databases. Values will be read from  
# the first database in the stack to contain a value. In this example,  
# writes always go to the first database.  
#Name: fulldb  
#Driver: Stack  
#Stack: configdb, remotedb  
#  
# In this example, we'd use Config: fulldb at the top of the file  
# to make it use the combination of the databases.  
#  
# Even more complex and interesting setups are possible, see the    
# debconf.conf(5) page for details.
```

## DB connection
`mysql -u safeuser_02 -pCYm2bKYSdu3fnwvtAx5dwXUz -h 127.0.0.1 -D safeshop_02`
formost
hexedit


https://github.com/carlospolop-forks/ctf-usb-keyboard-parser
