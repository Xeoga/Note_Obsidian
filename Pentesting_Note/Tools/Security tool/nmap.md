[[nmap-cheatsheet-19]]
`-sA` -- Scanarea de tipul [[TCP]] ACK
`-sS` -- Scanarea de tip [[TCP]] SYN,  scanarea ascunsa 
`-sU` -- Scanarea de tip [[UDP]]
`-sT` -- Scanarea de tip Connect 
`-sN` -- scanare de tip `Null` in header la [[TCP]] nu se seteaza nici un flag si daca acesta raspunde atunci portul este `open`,`filtred` trebuie privilegi de `sudo`.
`-sF` -- scanarea de tip `FIN` seteaza flagul in `FIN` in headerul de la [[TCP]] la fel ca si `NULL` poate fii `open`,`filtred`.
`-sX` – acest tip de scanare seteaza urmatoarele flaguri in headerul de [[TCP]] `FIN`,`URG`,`PSH`
`-sI` – daca in reteau avem un printer care nu este folosit putem sal folosim pentru ca el sa primeasca raspunsurile de scanare

### Scanarea retelei
`-sL` – lista de scanare simpla `(1.1.1.13/29)` 
`-iL` – transmite o lista de [[IP]], sau domeni de scanare
`-sn` – scaneaza daca `hostul` este `up` sau `down` foloseste [[ICMP]]
`-PR` – scaneaza reteau dar cu protocolul [[Network/Network Protocols/ARP]](trebuie sa fie locala) se foloseste in comitet cu `-sn`
`-PE` – foloseste [[ICMP]] echo pentru a detecta daca host-ul este `up` sau daca nu 
`-PP` – foloseste asa numit [[ICMP]] Timestamp sau altfel numit 
`-PM` – foloseste asa numit [[ICMP]] Address Mask 
`-PS` – in acest caz se foloseste SYN/ACK se poate de aratat si diapozonul de porturi `-PS80,8080`
`-PA` – transmite doar ACK/RST (sudo) se poate de aratat si diapozonul de porturi `-PA21-25`
`-PU` – scanarea de tip [[UDP]] 
### Custom Scan
In acest caz noi singuri putem sa specificam care flaguri sa le setam:
`--scanflags ACKSYN` – va seta 2 flaguri `ACK`,`SYN`.
`--scanflags RSTSYNFIN` – in felul dat putem sa setam flagul `RST`,`SYN`,`FIN`.
`-D <IP>,<IP>,RND,RND,ME TARGET_IP` - in acest caz spunem ca dorim ca traficul nostru despre starea la porturile deschise, inchise sa fie readresat la `IP_1`,`IP_2`,`RND` (care este un `IP` random) si `ME` care este masina noastra.

### Version detecting
`-sV` – detecteaza versiunea la serviciul pe care sta portul nostru
`--version-intesity <0-9>` – intensitatea cu care dorim sa aflam versiunea la serviciul nostru
`--version-light` – intensitatea este 2
`--version-all` – intensitaeta este 9

### OS detecting
`-O` – detectarea sistemului de operare 
`-A` –  ?
`--traceroute` –


`-sn` -- ping scan la fel ca si [[netdiscover]] dar trebuie de indicat masca
`-A` -- ne arata toata informatia versiunea,serviciul, si mai multe.
`-p` -- Ne arata care diapozan de porturi trebuie sa scanam
`-n` -- nu face un apel la un server de [[DNS]] deci nu face rezolutie la domain
`-R` – face un apel si cauta serverele [[DNS]] pentru sistemul dat (reverse DNS lookup)
`-F` – face ca scanarea sa fie rapidat si taie din cele 1000 de porturi si scaneaza doar 100 cele mai intalnite 
`--dns-servers` – specificam la care server dorim sa facem apelul
`-D` -- Schimba [[IP]] adresa hostului real cu altele care sunt dispartite prin `:` [[IP]] la hosturile false trebuie sa fii vii.
`-f` – defragmentatia la pachet daca avem un pachet de `64` bytes atunci vom transmite 8 pachete defragmentate `8`
`-ff` – defragmenteaza datele mai mult in `16` daca avem `64` atunci avem 4 pachete in total
`-S` -- ?
`2-dns-server` -- 
`2-source-port` -- 


## Scripturile in nmap
`NSE` -> Nmap Script Engine
- `safe`:- Won't affect the target
- `intrusive`:- Not safe: likely to affect the target  
- `vuln`:- Scan for vulnerabilities
- `exploit`:- Attempt to exploit a vulnerability
- `auth`:- Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously)
- `brute`:- Attempt to bruteforce credentials for running services
- `discovery`:- Attempt to query running services for further information about the network (e.g. query an SNMP server).
- `/usr/share/nmap/scripts` -> locul unde se afla toate scripturile de NSE
To download script:
```bash
sudo wget -O /usr/share/nmap/scripts/<script-name>.nse https://svn.nmap.org/nmap/scripts/<script-name>.nse
```
Update db:
```bash
nmap --script-updatedb
```
[More](https://nmap.org/book/nse-usage.html) Info NSE scripts

- `-f`:- Used to fragment the packets (i.e. split them into smaller pieces) making it less likely that the packets will be detected by a firewall or IDS.
- An alternative to `-f`, but providing more control over the size of the packets: `--mtu <number>`, accepts a maximum transmission unit size to use for the packets sent. This _must_ be a multiple of 8.
- `--scan-delay <time>ms`:- used to add a delay between packets sent. This is very useful if the network is unstable, but also for evading any time-based firewall/IDS triggers which may be in place.
- `--badsum`:- this is used to generate in invalid checksum for packets. Any real TCP/IP stack would drop this packet, however, firewalls may potentially respond automatically, without bothering to check the checksum of the packet. As such, this switch can be used to determine the presence of a firewall/IDS.

| Script Category | Description                                                            |
| --------------- | ---------------------------------------------------------------------- |
| `auth`          | Authentication related scripts                                         |
| `broadcast`     | Discover hosts by sending broadcast messages                           |
| `brute`         | Performs brute-force password auditing against logins                  |
| `default`       | Default scripts, same as `-sC`                                         |
| `discovery`     | Retrieve accessible information, such as database tables and DNS names |
| `dos`           | Detects servers vulnerable to Denial of Service (DoS)                  |
| `exploit`       | Attempts to exploit various vulnerable services                        |
| `external`      | Checks using a third-party service, such as Geoplugin and Virustotal   |
| `fuzzer`        | Launch fuzzing attacks                                                 |
| `intrusive`     | Intrusive scripts such as brute-force attacks and exploitation         |
| `malware`       | Scans for backdoors                                                    |
| `safe`          | Safe scripts that won’t crash the target                               |
| `version`       | Retrieve service versions                                              |
| `vuln`          | Checks for vulnerabilities or exploit vulnerable services              |