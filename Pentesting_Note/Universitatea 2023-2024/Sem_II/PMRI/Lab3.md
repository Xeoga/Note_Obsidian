## Analiza memorie RAM
Rulam malware:
![[Pasted image 20240519111521.png]]
Dupa rularea `LokiBot` facem un snapshot la machina noastra:
![[Pasted image 20240519112739.png]]
Retragem `dump`-ul de memorie:
![[Pasted image 20240519112931.png]]
Fisierul cu extensia `.vmem` si este dumpul nostru cel `.vmsn` este pentru configurarea VmWare. 
Analizam procesele care sunt rulate pe masina infectata:
```bash
vol3 -f Loki_dump_memory.vmem windows.pslist
```
![[Pasted image 20240519112258.png]]
In cazul nostru procesul infectat este `pythonw.exe` care are `pid` 2444:
![[Pasted image 20240519113056.png]]
Verificam ce comenzi pornesc acest proces:
```bash
vol3 -f LokiBot_dump_memory.vmem windows.cmdline
```
![[Pasted image 20240519113959.png]]
Aceste handle-uri includ ferestre, fișiere, procese și alte obiecte gestionate de sistemul de operare.
```bash
vol3 -f LokiBot_dump_memory.vmem windows.handles|grep "pythonw.exe"
```
![[Pasted image 20240519115853.png]]
Verificam toate `dll` care sunt folosite pentru instansat noastra:
```bash
vol3 -f LokiBot_dump_memory.vmem windows.dlllist|grep "pythonw.exe"
```
![[Pasted image 20240519115912.png]]
Avem drumul absolut 
```
2444    pythonw.exe     0x1c250000      0xc000  pythonw.exe     C:\Python27\pythonw.exe N/A     Disabled
```

## Analiza memorie hard 
Cloname masina virtuala:
![[Pasted image 20240520113808.png]]
Transformam din extensia de `.vmdk` in `.raw`:
```cmd
vmware-vdiskmanager -r "D:\VirtualMachine\Clone Win10\Windows 10 x64-cl1.vmdk" -t 0 "E:\Dump_of_disk\Windows 10 x64-cl1.raw"
```
Montam discul nostru:
![[Pasted image 20240520115705.png]]
Urmatorul pas este sa analizam discul nostru offline in putem face asta cu [[autorun]]:
![[Pasted image 20240521063757.png]]
Dupa un tip de timp avem schimbarile care sau produs in sistema:
![[Pasted image 20240521064139.png]]
Localizarea fisierilor din `Prefetch`:
![[Pasted image 20240521070655.png]]
Analiza fisierilor `pf` din `Prefetch`:
```cmd 
PECmd.exe -f "C:\Users\Adminstrator\Desktop\Prefetch\LOKIBOT_V2.EXE-67C57008.pf"
```
![[Pasted image 20240521085228.png]]
![[Pasted image 20240521085244.png]]
![[Pasted image 20240521085304.png]]
Pentru a înțelege mai bine comportamentul aplicațiilor.

Analiza fisierilor `HIVE` care:
![[Pasted image 20240521131411.png]]
Din pacate informatie utila este doar data si cine a rulat fisierul.

Analiza logurilor:
```path
I:\Windows\System32\winevt\Logs
```
![[Pasted image 20240521135322.png]]
Setam locatia pentru fisierile noastre de log:
![[Pasted image 20240521135701.png]]
Lol am gasit cum am adaugat ca un dir sa nu fii scanat dar nu am gasit nimic despre `malware->lokibot` =(
![[Pasted image 20240521140534.png]]
Presupunerea mea este ca acesta este procesul infectat:
![[Pasted image 20240521140624.png]]
Concluzie: În cele din urmă, deoarece prima versiune a malware-ului a fost scursă și clonată, devenind în cele din urmă disponibilă pentru un preț semnificativ mai mic decât originalul, Spyware-ul LokiBot a devenit un malware larg răspândit, care continuă să apară în mai multe campanii de mail-spam. De fapt, virusul a devenit atât de popular încât videoclipurile sale explicative de configurare privind furtul de acreditări sunt disponibile public pe YouTube.

Referinte:
https://any.run/malware-trends/lokibot